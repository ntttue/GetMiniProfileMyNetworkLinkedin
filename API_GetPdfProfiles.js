// var profileId = ["dungtiendinh"];
var profileId = ["quy-tran-as-tuanquynet-74b3168a","hoa-vo-b12a73141","bui-phuong-khanh-62451463","nguyen-huynh-nghi-a34277117","bui-dinh-mao-ab9036119","tuan-nam-nguyen-2a141712a","hanoref-co-ltd-742489135","t%C3%A2m-nhi-a0652a13b","dong-phuong-group-83156813b","nguyen-thi-thuy-trinh-31a674143","trinh-thanh-979b4798","y-muon-pham-483104aa","if-you-journey-to-viet-nam-b774176b","yen-tran-922499109","yen-nguyen-thanh-303b52111","seo-ho%C3%A0ng-qu%C3%A2n-8a8673124","h%E1%BB%93ng-nga-394852124","trang-le-68134b125","linh-tran-maria-683983127","duy-kien-tran-02396a134","gi%E1%BA%A5y-dolos-529630136","pham-hue-24916013a","phi-ngoc-thuy-41706613a","luci-nh%C6%B0-ho%C3%A0ng-hr-strategy%C2%AE-04207837","nguy%E1%BB%85n-h%E1%BB%93ng-h%C3%A2n-41a00451","nguyenth14","uyen-nguyen-kim-6052a9b0","bui-le-874349b1","louis-le-1b1361b1","ha-dothanh-8abb7213a","ton-tri-54801b13b","nh%E1%BA%ADt-ti%C3%AAn-tr%E1%BA%A7n-690326106","ailene-martinez-b62a89120","khangduypham","nguyen-lien-6a692b30","embrace-it-a726a9149","nguy%E1%BB%85n-ho%C3%A0ng-s%C6%A1n-v%C3%A2n-1401baa9","khanh-nguyen-ngoc-van-22888378","tran-hoa","sharmi-j-58a473135","son-nguyen-trong-8b5469134","melody-tr%E1%BA%A7n-0595b8139","kina-nguyen-ba232a148","tinh-ngoc-a90045116","anthonyraspa","johnnguyencompassy","chau-ky-khanh-2a190a25","sieng-sokrith-79135625","duong-dung-86aa5b86","nguyen-thanh-304b19106","nha-nguyen-ba525875","hung-tran-a599382a","nguyen-dinh-thy-giao-81759226","xuan-nguyen-son-427393a3","tran-phong-acca-97b01aba","yen-tran-922499109","nhat-pham-65560417","mai-hoang-09a91311","tho-anh-pham-88a02422","son-nguyenthai-397b313a","james-silverstone-40b781a7","chau-le-dan-1766a549","thao-la-95216112","chuong-quang-tran-mr-4a241636","pham-anh-tuan-a0326091","alex-duy-nguyen-86039719","haovp","vinh-duong-ngoc-b7586b40","nick-nhan-huynh-49492498","phu-huynh-4889b5135","jas-l-2b593146","kelly-phamuk-a4318684","tri-pham-314134112","truong-ai-phuong-3a24b74a","thuy-nguyen-thu-74158022","tran-nga-563b9615","quang-bui-huu-01879a19","logistics-institute-033a0527","tr-duong-nguyen-424a9428","joseph-phuc-phan-9a9a6212","pham-huy-14b59031","nguyen-thanh-ty-4228905a","le-van-trung-7bb73076","nam-tran-acca-cpa-canada-mba-76903539","toan-nd-77888039","vinh-pham-phu-7617112b","hau-do-77252465","tu-nguyen-16872579","nam-tien-tran-ocp-83303434","phattruong","anh-tuan-nguyen-156223103","huu-nhan-phong-kham-78a0a413b","stefan-bratasanu-41541913b","dang-le-hai-755233a7","tu-ngan-nguyen-1a598558","jimmy-man-95598447","rose-nguyen-64308563","long-nguyen-van-4294a631","ngoc-nguyen-4a366152","duy-cao-8351a456","1645840514","hoang-aka-623468120","san-ho-844b9536","thuy-nguyen-mba-cgma-4ab77b8","ibivietnam","mai-hoang-09a91311","voquoccuong","do-nguyen-ngoc-thu-a9b34133","nguy%E1%BB%85n-h%E1%BB%93ng-h%C3%A2n-41a00451","nguy%E1%BB%85n-t%C6%B0%E1%BB%9Dng-duy-b048a948","binh-m-s-rsp-lsp-cmiosh-miirsm-a4565553","duy-tran-21062b4b","nguyen-tuanh-00495756","tran-duc-quynh-815a5b3b","nguyen-loc-69020461","nguyen-huu-hanh-789a3a45","ng%C3%A2n-tr%E1%BA%A7n-thu-1a297164","tram-huyen-vu-b2836568","ngo-nhu-tuan-3b2a2712","torrance-az-18aa7849","quang-l%C3%AA-51885157","nguyen-thanh-hai-pmp-greenbelt-certificate-3564a126","nguyen-lien-6a692b30","le-nguyen-5809a2a5","thai-tu-b9287327","luz-l-71891622","sophia-stewart-3039ab14","th%C3%B4ng-tin-tuy%E1%BB%83n-d%E1%BB%A5ng-a8b4a06a","tr%E1%BA%A7n-ho%C3%A0ng-h%E1%BA%A1nh-b0121196","charles-ngodinh-vnguide-18007336","train2link-recruitment-23783235","viet-long-nguyen-asa-aust-807875103","liu-peng-4a6034a5","quyen-tran-05646383","triet-tran-cpa-06a1b8b8","my-ha-van-21898626","uyen-nguyen-kim-6052a9b0","quang-tuan-le-b6771161","nga-tr%E1%BB%8Bnh-th%E1%BB%8B-thi%C3%AAn-09a401115","tr%E1%BA%A7n-anh-tu%E1%BA%A5n-wilson-a0863570","phong-le-huynh-1b942299","th%C3%A2%CC%A3n-ng%C3%B4-0a9021129","quang-anh-luu-64b595126","thuy-vu-5ab344126","nguy%E1%BB%85n-h%E1%BB%93ng-nhung-806ab126","binh-nguyen-pmp%C2%AE-pmi-acp%C2%AE-pmi-rmp%C2%AE-pmi-sp%C2%AE-msc-2b11ab20","thai-duong-bui-quang-6755b8a7","su-nandar-latt-146b80b2","beptu-chatluong-310141117","anh-hoang-phi-53879014","my-hoang-bui-1030a1128","do-ronald-b88986b8","billwastontrade","nguyen-thanh-tung-210302111","h%E1%BB%93ng-nga-394852124","ms-anna-pha%CC%A3m-238590101","nguy%E1%BB%85n-ho%C3%A0ng-s%C6%A1n-v%C3%A2n-1401baa9","lukas-lukas-6067b8111","thi%C3%AAn-kh%C3%B4i-a80443130","k%E1%BA%BF-to%C3%A1n-%C4%91%E1%BB%A9c-h%C3%A0-a07744b8","tony-nguyen-03a794112","ibiglobal","yogi-ra-a9459261","le-thi-hai-yen-78a5b327","gi%E1%BA%A5y-dolos-529630136","nam-chanida-74082b74","nguyen-van-thu-82529124","nguyen-phong-nguyen-0bb826ab","hanoref-co-ltd-742489135","hai-quyen-cao-8a74211b","robert-nguyen-b4152180","ti%E1%BA%BFn-anh-chu-6a8a0190","shimizu-dung-39210a84","dong-phuong-group-83156813b","trinh-dn-b8594410b","toan-pham-5a69a8125","trang-le-68134b125","th%C6%B0-h%C3%A0-lan-41552a18","simon-truong-854111b","phuong-nguyen-886022aa","derrick-tan-%E9%99%88-49797521","huy-nguyen-aa53738b","thuy-nguyen-588441141","thai-quang-nguyen-a0408337","linh-thuy-4a487832","kieu-manh-tien-61736b98","minh-tran-tran-86141139","tran-viet-72733a3b","ruby-nguyen-90265299","dau-kieu-duc-dung-b142b958","frank-h-189627a1","duyen-nguyen-20a009bb","trinh-nguyen-04a692143","nhat-dang-min-18a7a269","b%E1%BA%A3o-h%E1%BB%AFu-joseph-a5099974","vo-loan-51a29950","phuong-pham-quynh-thanh-aa243938","phanquan-pc-8566397a","tuong-doan-kiet-388a16aa","903256788","tien-le-a906b812a","quoc-nam-nguyen-1636a7a9","hai-le-ba-07070bb0","l%C3%AA-h%E1%BB%93ng-s%C6%A1n-264ba2100","nh%E1%BA%ADt-minh-nguy%E1%BB%85n-815916b1","ken-v%C5%A9-l%C3%AA-hr-strategy-7a0211109","phi-bao-nhu-tran-5a7704105","h%E1%BA%ADu-nguy%E1%BB%85n-967825100","uyen-wendy-tran-559120120","tr%E1%BB%8Bnh-trinh-37136956","kim-ho%C3%A0ng-515062108","hoang-van-834856b8","nguyen-hong-ngoc-969717129","roman-nguyen-9bb57694","chi-cuong-bach-4778a030","nguy%E1%BB%85n-dung-0a128b143","ph%E1%BA%A1m-vi%E1%BB%87t-485287131","dau-mai-24124111a","vine-le-b5b979120","xuan-hong-le-4a3a96120","khanh-nguyen-phuong-172224104","thanh-ly-minh-543982135","tran-thi-mai-le-628a00125","tuan-ho-75a788141","linh-nguy%E1%BB%85n-75a286128","nguy%E1%BB%85n-th%E1%BB%8B-tuy%E1%BA%BFt-loan-95456813b","thuy-trinh-407207143","trang-luong-659940b4","tr%E1%BA%A7n-thu-h%E1%BB%93ng-761949132","bui-dung-41a805148","tuy%E1%BA%BFn-tr%E1%BA%A7n-634004105","ha-ngan-10ab9b139","tien-nghi-duong-25a0a592","julia-pham-26425296","vinh-luu-truong-935143b0","truong-nguyen-thong-thien-342240b7","luong-thuy-quynh-1a3001110","thuy-vu-5ab344126","thao-le-thi-phuong-563a23133","huy-bich-nguyen-aa2793b6","phan-but-canh-6a4466124","vi%E1%BB%87t-chinh-nguy%E1%BB%85n-63003984","b%E1%BA%A3o-nguy%E1%BB%85n-tr%C6%B0%C6%A1ng-minh-1b868b112","tr%E1%BA%A7n-th%E1%BB%8B-m%E1%BB%B9-trinh-06b45513a","di%C3%AA%CC%83n-l%C3%AA-38551613a","stephen-tran-dt-thuan-acca-cpa-431a48a7","daniel-doan-154923116","thanh-ki%E1%BB%81u-mai-047569128","ht-sophie-4b1476a4","t%C3%B9ng-l%C3%A2m-l%C3%BD-276087144","nhu-thuyen-992236106","phuong-quynh-do-92a49834","huong-junbi-7175b312a","minh-diep-16273812a","le-truong-t-my-alex-42077712a","dean-ngo-489944a4","hunter-macdonald-1a138b147","thanh-pham-hoai-35b5b6b5","minh-gia-huy-nguyen-99a315134","thu-nguyen-anh-133630b9","ti%E1%BA%BFn-nguy%E1%BB%85n-ho%C3%A0ng-b71596a3","thu-ph%C6%B0%C6%A1ng-5a295a141","xone-radio-938651b4","hong-tran-rose-mba-b28b0062","luke-nguyen-529081119","annie-n-a3595910a","tri%E1%BB%81u-l%C3%AA-duy-779897119","hami-tran-15438959","y-vy-430a1412a","le-tin-b81566bb","ipeak","anh-do-08454168","tien-duy-b-le-25159829","thanh-duc-dong-7a542275","2512848","angie-tran-95263694","zalo-group-2b72a4131","t%C3%B9ng-nguy%E1%BB%85n-thanh-51109036","le-thi-doan-trang-82209563","david-quan-1190804a","kim-nguy%E1%BB%85n-58701473","king-dink-08034742","dat-trieu-dinh-76b22763","binh-tran-thanh-b362749b","ngo-tan-thinh-64057356","nguyen-vu-trung-1aa85a46","vo-duy-thuc-609384113","gia-linh-nguyen-7b930755","nguy%E1%BB%85n-t%C6%B0%E1%BB%9Dng-duy-b048a948","nguyen-hoang-khuong-03381110a","ph%E1%BA%A1m-kh%C3%B4i-8b55a227","peter-vo-24515055","dinh-hoai-chuc-30878961","nguyen-dung-167b0312a","quy-tran-97961a90","phong-le-thanh-3632a272","adeccovietnam","","https:/www.linkedin.com/ilbertoservienti","hoa-nguyen-huu-4320818","https:/www.linkedin.com/ilessandra-leni-mark-manager/","https:/www.linkedin.com/iamir-hashmi-a6479a2a","https:/www.linkedin.com/irnauddemarrez","#","https:/www.linkedin.com/icclou","https:/www.linkedin.com/indy-do-9ab23483","https:/www.linkedin.com/ilviss-ha-620b5683","carlos-fatas-aa902284","https:/www.linkedin.com/ilex-nguyen-77980335","https:/www.linkedin.com/inhdao706","https:/www.linkedin.com/ibhishek-makhija-aa38a235","https:/www.linkedin.com/inhtuanvnsecurity","https:/www.linkedin.com/ibdelhalim-abbassa-8k%F0%9F%94%B5-80147835","jimmy-lee-fcpa-fcma-cgma-mba-ca-m-004b6533","https:/www.linkedin.com/inhtu79","heitie-haitrieu-bb934a37","https:/www.linkedin.com/in-na-le-le-38b12138","0","nguyen-hung-8a9b1098","https:/www.linkedin.com/inh-ha-a09b4198","https:/www.linkedin.com/inh-bui-99531799","https:/www.linkedin.com/inh-duy-le-09456399","thang-dong-quang-2837b1a0","https:/www.linkedin.com/inhduc0905","tram-tran-62ab03147","engineering-management-consultant-705192b6","nguy%E1%BB%85n-%C4%91o%C3%A0n-ph%C6%B0%E1%BB%9Bc-duy-95178bb6","https:/www.linkedin.com/indyhnguyen92","https:/www.linkedin.com/ilynpim","https:/www.linkedin.com/in-nguyen-97a211106","https:/www.linkedin.com/inhvi-le-bb6905102","https:/www.linkedin.com/inna-lu-07942a104","novaon","minh-sy-56b183135","nhan-doan-253428130","https:/www.linkedin.com/inh-l%C3%AA-46217b141","https:/www.linkedin.com/in-vu-4a90a673","hien-pham-thanh-a01061143","https:/www.linkedin.com/in-pham","https:/www.linkedin.com/ilex-tran-b8b23a80","https:/www.linkedin.com/inh-do-b59b5a109","https:/www.linkedin.com/idele-nguyen-04690a49","https:/www.linkedin.com/indrea-pazzona-222b1749","barinder-singh-barry-595ab953","https:/www.linkedin.com/imanda-wang-257a3212/","thang-nguyen-manh-13ba4412","https:/www.linkedin.com/inh-dao-9690a493","t%C3%A1m-ng%C3%B3n-ph%C6%B0%E1%BB%9Bc-73906885","https:/www.linkedin.com/inh-ngoc-le-thi-8b116795","mai-nguyen-quynh-24325a95","https:/www.linkedin.com/ilessandro-di-lena-9a1a39a3","https:/www.linkedin.com/inh-quynh-pham-285369a4","https:/www.linkedin.com/idel-ghelis-804640aa","vu-nguyen-hoang-957305ab","https:/www.linkedin.com/ivik-banerjee-1179aa15/","chinh-vo-60453715","trinh-hoai-van-91b41820","ngocbrit","https:/www.linkedin.com/imanda-walser-18075b31","https:/www.linkedin.com/intaryami-panigrahi-67830956","https:/www.linkedin.com/inh-tu-pham-mr-9b8b8b5b","https:/www.linkedin.com/ilex-trung-03455b62","thuy-lanh-nguyen-67650063","https:/www.linkedin.com/in-thuy-truong-23ab4b65","david-t-larson-21562a66","https:/www.linkedin.com/inhtuanvo","duy%C3%AAn-k%E1%BB%B3-119aa6141","ph%E1%BA%A1m-ng%E1%BB%8Dc-b%C3%ADch-3b4b22142","https:/www.linkedin.com/iurelio-mortoni-a6a79141","https:/www.linkedin.com/inh-phuong-ta-54712248","https:/www.linkedin.com/inhphamhai","https:/www.linkedin.com/inh-tuan-48000451","https:/www.linkedin.com/inhh1","thanh-nguyen-phd-84216722","https:/www.linkedin.com/inh-doan-quoc-a6131430","https:/www.linkedin.com/ihna-k-a-9026a032","https:/www.linkedin.com/idrianlim-moxieamplifier/","https:/www.linkedin.com/iakash-nair","ph%C6%B0%E1%BB%A3ng-h%E1%BA%B1ng-b35b5a10b","https:/www.linkedin.com/inhngotu","hhtvvn","panchuk-james-236123120","https:/www.linkedin.com/inny-nguyen-38a8b0124","thu-th%E1%BA%A3o-nguy%E1%BB%85n-644356125","nga-nguyen-5200221a","https:/www.linkedin.com/inphatdat-cty-274275128","michelle-v%C5%A9-lan-940897130","maria-h%C6%B0%C6%A1ng-5b98b7131","https:/www.linkedin.com/is-design-213031133","khanh-pham-a40371145","bich-tien-19a4aa131","https:/www.linkedin.com/inatoly-ogibenin-9a850571","https:/www.linkedin.com/isimo155","https:/www.linkedin.com/ilice-nguyen-29813a79","https:/www.linkedin.com/inh-tran-1213633a","mustafa-haimour-a7705741","https:/www.linkedin.com/imy-pham-6517604b","https:/www.linkedin.com/indy-pham-pmp-4867664b","h-van-b68690145","bui-le-874349b1","th%E1%BA%A3o-tr%E1%BA%A7n-215ba78b","hoa-le-minh-hoa-b416578a","https:/www.linkedin.com/inhthulee","https:/www.linkedin.com/ishleyphuonganh","pongkorn-lapchevasit-04382092","que-tram-nguyen-784b3395","thanh-khoi-nguyen-a3493697","https:/www.linkedin.com/inh-v%C3%A2n-a9b274a2","https:/www.linkedin.com/ingela-nguy%E1%BB%85n-aa5b46a6","v%C3%B5-mai-th%C6%B0%C6%A1ng-35ab38a6","thanh-t%C3%A2m-jennie-67b662ab","https:/www.linkedin.com/iuphuc","hi%E1%BB%83u-my-528775b4","https:/www.linkedin.com/inh-duy-a4276458","https:/www.linkedin.com/inhlevn","phan-vu-nam-90b32767","poe-nguyen-59a931104","energy-saving-solution-asia-essa-9253b110b","https:/www.linkedin.com/innguyenphuoc","huy%E1%BB%81n-mai-60a87677","https:/www.linkedin.com/ibigailbaniqued","khanh-phan-minh-8a84964b","https:/www.linkedin.com/inongnardsmailkul","ngoc-linh-nguy%E1%BB%85n-v%C5%A9-b170a592","https:/www.linkedin.com/iinguyen28031993","https:/www.linkedin.com/imydang2020","https:/www.linkedin.com/inthony-la-ki%E1%BA%BFn-m%E1%BB%B9-8bb36013/","https:/www.linkedin.com/inh-phan-62079911a","https:/www.linkedin.com/inhly18","https:/www.linkedin.com/irun-mittal-7b754428","https:/www.linkedin.com/in-nguyen-thanh-5b254128","https:/www.linkedin.com/in-th%C3%A0nh-0858568a","https:/www.linkedin.com/inh-buinguyenha-230b6891","https:/www.linkedin.com/indy-quang-5a20929b","https:/www.linkedin.com/ilbertdo","https:/www.linkedin.com/in-tr%C6%B0%E1%BB%9Dng-b65272ba","tranthuytien-ti%E1%BB%83ulong-40916871","https:/www.linkedin.com/imelia-trinh-7a194540","dang-pham-81b1803a","https:/www.linkedin.com/inmnttvy","https:/www.linkedin.com/ilex-matsko-874775a2","https:/www.linkedin.com/inatoldukanov/","https:/www.linkedin.com/intran7k/","ho-le-60372a120","https:/www.linkedin.com/intran7k","https:/www.linkedin.com/inh-lam-quang-tuan-194339b1","https:/www.linkedin.com/ilessandroxu/","https:/www.linkedin.com/inders-%C3%B6stberg-9bb42b21","ngoc-quy-tran-27380ba","https:/www.linkedin.com/inna-quang-thi-thuan-an-80751877","https:/www.linkedin.com/inh-tuan-nguyen-441b48a6","https:/www.linkedin.com/imazona-vietnam-5a16b5103","https:/www.linkedin.com/inh-khoa-00037012b","ph%C6%B0%C6%A1ng-lan-baby-941b67124","https:/www.linkedin.com/inh-nguyen-the-96758512b","hieu-bui-thi-minh-hieu-332405138","https:/www.linkedin.com/indy-pang-54003395","https:/www.linkedin.com/inh-do-thi-lan-408043b8","https:/www.linkedin.com/inh-le-emily-9b88635a","vu-thanh-binh-44189524","https:/www.linkedin.com/idnan-polat-79562011b","https:/www.linkedin.com/inh-thuc-hoang-quang-32a0b791","kh%C3%A1nh-vi-b60b2611b","https:/www.linkedin.com/inh-hong-van"];
;

function removeA(arr) {
    var what, a = arguments, L = a.length, ax;
    while (L > 1 && arr.length) {
        what = a[--L];
        while ((ax = arr.indexOf(what)) !== -1) {
            arr.splice(ax, 1);
        }
    }
    return arr;
}

function exportFile(data, filename) {

    if (!data) {
        return;
    }

    if (!filename) filename = 'console.json';

    if (typeof data === "object") {
        data = JSON.stringify(data, undefined, 4)
    }

    var blob = new Blob([data], {type: 'text/json'}),
        e = document.createEvent('MouseEvents'),
        a = document.createElement('a');

    a.download = filename;
    a.href = window.URL.createObjectURL(blob);
    a.dataset.downloadurl = ['text/json', a.download, a.href].join(':');
    e.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
    a.dispatchEvent(e)
}

var failToDownloadPDF = [];

function getPDFProfile(dmsLink, idProfile) {
    return new Promise(resolve => {
        var namePDF = decodeURI(idProfile);
        var req = new XMLHttpRequest();

        function reqListener() {
            if (req.readyState === 4 && req.status === 200) {
                var filename = namePDF + ".pdf";
                if (typeof window.chrome !== 'undefined') {
                    // Chrome version
                    var link = document.createElement('a');
                    link.href = window.URL.createObjectURL(req.response);
                    link.download = namePDF + ".pdf";
                    link.click();
                } else if (typeof window.navigator.msSaveBlob !== 'undefined') {
                    // IE version
                    var blob = new Blob([req.response], {type: 'application/pdf'});
                    window.navigator.msSaveBlob(blob, filename);
                } else {
                    // Firefox version
                    var file = new File([req.response], filename, {type: 'application/force-download'});
                    window.open(URL.createObjectURL(file));
                }
            } else {
                if (failToDownloadPDF.indexOf(idProfile) === -1) {
                    failToDownloadPDF.push(idProfile);
                }
            }
        }

        req.addEventListener("load", reqListener);
        req.open("GET", dmsLink, true);
        req.responseType = "blob";
        req.send();
    });

}

var dmsLink = {};

// send POST pdf profile
function getCookie(name) {
    var value = "; " + document.cookie;
    var parts = value.split("; " + name + "=");
    if (parts.length === 2) return parts.pop().split(";").shift().replace('"', '').replace('"', '');
}

var csrfToken = getCookie('JSESSIONID');
var succeedGetProfile = [];
var failGetProfile = [];

// send POST pdf profile
function POSTRequest(idProfile) {
    return new Promise(resolve => {
        var linkRequest = "https://www.linkedin.com/voyager/api/identity/profiles/" + idProfile + "/profileActions?versionTag=3123833624&action=saveToPdf";
        var xhttp = new XMLHttpRequest();

        function reqListener() {
            resolve(JSON.parse(this.responseText));
            if (this.readyState === 4 && this.status === 200) {
                var parsedData = JSON.parse(this.responseText);
                dmsLink[idProfile] = parsedData.value;
                // getPDFProfile(parsedData.value, idProfile)
                var index = failGetProfile.indexOf(idProfile);
                if (index > -1) {
                    removeA(failGetProfile, idProfile);
                }
            } else {
                if (failGetProfile.indexOf(idProfile) === -1) {
                    failGetProfile.push(idProfile);
                }
            }
        }
		 xhr.timeout = 1000;
        xhttp.addEventListener("load", reqListener);
        xhttp.open("POST", linkRequest, true);
        xhttp.setRequestHeader("csrf-token", csrfToken);
        xhttp.send();
    });

}

var numberRecall = 1;
var limitRecall = 10;
var isDownloadPDF = false;
var isExportFailFile = false;

function recallGetProfile() {
    console.log(numberRecall);
    numberRecall += 1;
    var failPromies = [];
    failGetProfile.forEach(function (profile_fail) {
        failPromies.push(POSTRequest(profile_fail));
    });
    Promise.all(failPromies).then(function () {
        if (failGetProfile.length > 0 && numberRecall <= limitRecall) {
            setTimeout(function () {
                recallGetProfile();
            }, 5000);
        }
        if ((numberRecall > limitRecall && failGetProfile.length > 0) && isExportFailFile === false) {
            //save id cannot GetProfile to file pdf
            isExportFailFile = true;
            exportFile(failGetProfile.toString(), "profileID_Failed.txt")
        }
        if ((numberRecall > limitRecall || failGetProfile.length <= 0) && isDownloadPDF === false) {
            console.log("DONEEEEEEEEEEEEEEEEEEEEEEEEE");
            isDownloadPDF = true;
            var promiseDownloadPDF = [];
            for (var profile_id in dmsLink) {
                promiseDownloadPDF.push(getPDFProfile(dmsLink[profile_id], profile_id));
            }
            Promise.all(promiseDownloadPDF).then(function () {
                console.log(failToDownloadPDF);
            });
        }
    });
}

function main() {
    var promises = [];
    profileId.forEach(function (entry) {
        promises.push(POSTRequest(entry));
    });
    Promise.all(promises).then(function () {
        setTimeout(function () {
            recallGetProfile();
        }, 5000);
    });
}

main();